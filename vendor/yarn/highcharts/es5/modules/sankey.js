/*
 Highcharts JS v11.1.0 (2023-06-05)

 Sankey diagram module

 (c) 2010-2021 Torstein Honsi

 License: www.highcharts.com/license
*/
'use strict';(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts"],function(u){b(u);b.Highcharts=u;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function u(b,h,l,k){b.hasOwnProperty(h)||(b[h]=k.apply(null,l),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:h,module:b[h]}})))}b=b?b._modules:
{};u(b,"Series/NodesComposition.js",[b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],function(b,h){b=b.series;var l=b.prototype,k=b.prototype.pointClass.prototype,z=h.defined,v=h.extend,g=h.find,c=h.merge,e=h.pick,a;(function(a){function d(){this.data=[].concat(this.points||[],this.nodes);return l.destroy.apply(this,arguments)}function b(){this.nodes&&(this.nodes.forEach(function(a){a.destroy()}),this.nodes.length=0);l.setData.apply(this,arguments)}function y(a){var c=arguments,e=this.isNode?
this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==a&&e.forEach(function(a){a&&a.series&&(k.setState.apply(a,c),a.isNode||(a.fromNode.graphic&&k.setState.apply(a.fromNode,c),a.toNode&&a.toNode.graphic&&k.setState.apply(a.toNode,c)))});k.setState.apply(this,c)}function t(a,d,b,f){var m=this,n=this.series.options.nodes,p=this.series.options.data,B=p&&p.length||0,D=p&&p[this.index];k.update.call(this,a,this.isNode?!1:d,b,f);this.isNode&&(a=(n||[]).reduce(function(n,a,p){return m.id===
a.id?p:n},-1),f=c(n&&n[a]||{},p&&p[this.index]||{}),p&&(D?p[this.index]=D:p.length=B),n?0<=a?n[a]=f:n.push(f):this.series.options.nodes=[f],e(d,!0)&&this.series.chart.redraw(b))}var r=[];a.compose=function(a,c){h.pushUnique(r,a)&&(a=a.prototype,a.setNodeState=y,a.setState=y,a.update=t);h.pushUnique(r,c)&&(a=c.prototype,a.destroy=d,a.setData=b);return c};a.createNode=function(a){var c=this.pointClass,d=function(a,p){return g(a,function(a){return a.id===p})},f=d(this.nodes,a);if(!f){d=this.options.nodes&&
d(this.options.nodes,a);var m=(new c).init(this,v({className:"highcharts-node",isNode:!0,id:a,y:1},d));m.linksTo=[];m.linksFrom=[];m.getSum=function(){var a=0,p=0;m.linksTo.forEach(function(n){a+=n.weight||0});m.linksFrom.forEach(function(a){p+=a.weight||0});return Math.max(a,p)};m.offset=function(a,p){for(var n=0,c=0;c<m[p].length;c++){if(m[p][c]===a)return n;n+=m[p][c].weight}};m.hasShape=function(){var a=0;m.linksTo.forEach(function(n){n.outgoing&&a++});return!m.linksTo.length||a!==m.linksTo.length};
m.index=this.nodes.push(m)-1;f=m}f.formatPrefix="node";f.name=f.name||f.options.id||"";f.mass=e(f.options.mass,f.options.marker&&f.options.marker.radius,this.options.marker&&this.options.marker.radius,4);return f};a.destroy=d;a.generatePoints=function(){var a=this,c=this.chart,d={};l.generatePoints.call(this);this.nodes||(this.nodes=[]);this.colorCounter=0;this.nodes.forEach(function(a){a.linksFrom.length=0;a.linksTo.length=0;a.level=a.options.level});this.points.forEach(function(f){z(f.from)&&(d[f.from]||
(d[f.from]=a.createNode(f.from)),d[f.from].linksFrom.push(f),f.fromNode=d[f.from],c.styledMode?f.colorIndex=e(f.options.colorIndex,d[f.from].colorIndex):f.color=f.options.color||d[f.from].color);z(f.to)&&(d[f.to]||(d[f.to]=a.createNode(f.to)),d[f.to].linksTo.push(f),f.toNode=d[f.to]);f.name=f.name||f.id},this);this.nodeLookup=d};a.setNodeState=y;a.updateNode=t})(a||(a={}));return a});u(b,"Series/Sankey/SankeyPoint.js",[b["Core/Series/Point.js"],b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],
function(b,h,l){var k=this&&this.__extends||function(){var b=function(g,c){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,a){c.__proto__=a}||function(c,a){for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d])};return b(g,c)};return function(g,c){function e(){this.constructor=g}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");b(g,c);g.prototype=null===c?Object.create(c):(e.prototype=c.prototype,
new e)}}(),z=l.defined;return function(h){function g(){var c=null!==h&&h.apply(this,arguments)||this;c.className=void 0;c.fromNode=void 0;c.level=void 0;c.linkBase=void 0;c.linksFrom=void 0;c.linksTo=void 0;c.mass=void 0;c.nodeX=void 0;c.nodeY=void 0;c.options=void 0;c.series=void 0;c.toNode=void 0;return c}k(g,h);g.prototype.applyOptions=function(c,e){b.prototype.applyOptions.call(this,c,e);z(this.options.level)&&(this.options.column=this.column=this.options.level);return this};g.prototype.getClassName=
function(){return(this.isNode?"highcharts-node ":"highcharts-link ")+b.prototype.getClassName.call(this)};g.prototype.getFromNode=function(){for(var c=-1,e,a=0;a<this.linksTo.length;a++){var d=this.linksTo[a];d.fromNode.column>c&&d.fromNode!==this&&(e=d.fromNode,c=e.column)}return{fromNode:e,fromColumn:c}};g.prototype.setNodeColumn=function(){z(this.options.column)||(this.column=0===this.linksTo.length?0:this.getFromNode().fromColumn+1)};g.prototype.isValid=function(){return this.isNode||"number"===
typeof this.weight};return g}(h.seriesTypes.column.prototype.pointClass)});u(b,"Series/Sankey/SankeySeriesDefaults.js",[],function(){"";return{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkOpacity:.5,opacity:1,minLinkWidth:0,nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},
inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}});u(b,"Series/Sankey/SankeyColumnComposition.js",[b["Core/Utilities.js"]],function(b){var h=b.defined,l=b.relativeLength,k;(function(b){b.compose=function(b,c){b.sankeyColumn=new k(b,c);return b};var k=
function(){function b(c,b){this.points=c;this.series=b}b.prototype.getTranslationFactor=function(c){for(var b=this.points,a=b.slice(),d=c.options.minLinkWidth||0,x=0,h,g=(c.chart.plotSizeY||0)-(c.options.borderWidth||0)-(b.length-1)*c.nodePadding;b.length;){x=g/b.sankeyColumn.sum();c=!1;for(h=b.length;h--;)b[h].getSum()*x<d&&(b.splice(h,1),g-=d,c=!0);if(!c)break}b.length=0;a.forEach(function(a){b.push(a)});return x};b.prototype.top=function(b){var c=this.series,a=c.nodePadding,d=this.points.reduce(function(d,
e){0<d&&(d+=a);e=Math.max(e.getSum()*b,c.options.minLinkWidth||0);return d+e},0);return((c.chart.plotSizeY||0)-d)/2};b.prototype.left=function(b){var c=this.series,a=c.chart,d=c.options.equalNodes,h=a.inverted?a.plotHeight:a.plotWidth,g=c.nodePadding,k=this.points.reduce(function(a,e){0<a&&(a+=g);e=d?h/e.series.nodes.length-g:Math.max(e.getSum()*b,c.options.minLinkWidth||0);return a+e},0);return((a.plotSizeX||0)-Math.round(k))/2};b.prototype.sum=function(){return this.points.reduce(function(c,b){return c+
b.getSum()},0)};b.prototype.offset=function(b,e){var a=this.points,c=this.series,g=c.nodePadding,k=0;if(c.is("organization")&&b.hangsFrom)return{absoluteTop:b.hangsFrom.nodeY};for(var y=0;y<a.length;y++){var t=a[y].getSum();var r=Math.max(t*e,c.options.minLinkWidth||0),q=b.options[c.chart.inverted?"offsetHorizontal":"offsetVertical"],w=b.options.offset||0;t=t?r+g:0;if(a[y]===b)return{relativeTop:k+(h(q)?l(q,r):l(w,t))};k+=t}};return b}();b.SankeyColumnAdditions=k})(k||(k={}));return k});u(b,"Series/TreeUtilities.js",
[b["Core/Color/Color.js"],b["Core/Utilities.js"]],function(b,h){function l(a,b){var c=b.before,d=b.idRoot,h=b.mapIdToNode[d],g=b.points[a.i],r=g&&g.options||{},q=[],w=0;a.levelDynamic=a.level-(!1!==b.levelIsConstant?0:h.level);a.name=e(g&&g.name,"");a.visible=d===a.id||!0===b.visible;"function"===typeof c&&(a=c(a,b));a.children.forEach(function(c,d){var f=k({},b);k(f,{index:d,siblings:a.children.length,visible:a.visible});c=l(c,f);q.push(c);c.visible&&(w+=c.val)});c=e(r.value,w);a.visible=0<=c&&(0<
w||a.visible);a.children=q;a.childrenTotal=w;a.isLeaf=a.visible&&!w;a.val=c;return a}var k=h.extend,u=h.isArray,v=h.isNumber,g=h.isObject,c=h.merge,e=h.pick;return{getColor:function(a,c){var d=c.index,g=c.mapOptionsToLevel,h=c.parentColor,k=c.parentColorIndex,r=c.series,q=c.colors,w=c.siblings,l=r.points,f=r.chart.options.chart,m;if(a){l=l[a.i];a=g[a.level]||{};if(g=l&&a.colorByPoint){var n=l.index%(q?q.length:f.colorCount);var p=q&&q[n]}if(!r.chart.styledMode){q=l&&l.options.color;f=a&&a.color;if(m=
h)m=(m=a&&a.colorVariation)&&"brightness"===m.key&&d&&w?b.parse(h).brighten(d/w*m.to).get():h;m=e(q,f,p,m,r.color)}var B=e(l&&l.options.colorIndex,a&&a.colorIndex,n,k,c.colorIndex)}return{color:m,colorIndex:B}},getLevelOptions:function(a){var b={};if(g(a)){var h=v(a.from)?a.from:1;var k=a.levels;var l={};var t=g(a.defaults)?a.defaults:{};u(k)&&(l=k.reduce(function(a,b){if(g(b)&&v(b.level)){var d=c({},b);var k=e(d.levelIsConstant,t.levelIsConstant);delete d.levelIsConstant;delete d.level;b=b.level+
(k?0:h-1);g(a[b])?c(!0,a[b],d):a[b]=d}return a},{}));k=v(a.to)?a.to:1;for(a=0;a<=k;a++)b[a]=c({},t,g(l[a])?l[a]:{})}return b},setTreeValues:l,updateRootId:function(a){if(g(a)){var b=g(a.options)?a.options:{};b=e(a.rootNode,b.rootId,"");g(a.userOptions)&&(a.userOptions.rootId=b);a.rootNode=b}return b}}});u(b,"Series/Sankey/SankeySeries.js",[b["Core/Color/Color.js"],b["Core/Globals.js"],b["Series/NodesComposition.js"],b["Series/Sankey/SankeyPoint.js"],b["Series/Sankey/SankeySeriesDefaults.js"],b["Core/Series/SeriesRegistry.js"],
b["Series/Sankey/SankeyColumnComposition.js"],b["Series/TreeUtilities.js"],b["Core/Utilities.js"]],function(b,h,l,k,u,v,g,c,e){var a=this&&this.__extends||function(){var a=function(b,n){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var n in b)Object.prototype.hasOwnProperty.call(b,n)&&(a[n]=b[n])};return a(b,n)};return function(b,n){function c(){this.constructor=b}if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+
String(n)+" is not a constructor or null");a(b,n);b.prototype=null===n?Object.create(n):(c.prototype=n.prototype,new c)}}(),d=v.series,x=v.seriesTypes.column,z=c.getLevelOptions,y=e.clamp;c=e.extend;var t=e.isObject,r=e.merge,q=e.pick,w=e.relativeLength,I=e.stableSort;e=function(c){function d(){var a=null!==c&&c.apply(this,arguments)||this;a.colDistance=void 0;a.data=void 0;a.group=void 0;a.nodeLookup=void 0;a.nodePadding=void 0;a.nodes=void 0;a.nodeWidth=void 0;a.options=void 0;a.points=void 0;a.translationFactor=
void 0;return a}a(d,c);d.getDLOptions=function(a){var b=t(a.optionsPoint)?a.optionsPoint.dataLabels:{};a=t(a.level)?a.level.dataLabels:{};return r({style:{}},a,b)};d.prototype.createNodeColumns=function(){var a=[];this.nodes.forEach(function(b){b.setNodeColumn();a[b.column]||(a[b.column]=g.compose([],this));a[b.column].push(b)},this);for(var b=0;b<a.length;b++)"undefined"===typeof a[b]&&(a[b]=g.compose([],this));return a};d.prototype.order=function(a,b){var c=this;"undefined"===typeof a.level&&(a.level=
b,a.linksFrom.forEach(function(a){a.toNode&&c.order(a.toNode,b+1)}))};d.prototype.generatePoints=function(){l.generatePoints.apply(this,arguments);var a=this;this.orderNodes&&(this.nodes.filter(function(a){return 0===a.linksTo.length}).forEach(function(b){a.order(b,0)}),I(this.nodes,function(a,b){return a.level-b.level}))};d.prototype.getNodePadding=function(){var a=this.options.nodePadding||0;if(this.nodeColumns){var b=this.nodeColumns.reduce(function(a,b){return Math.max(a,b.length)},0);b*a>this.chart.plotSizeY&&
(a=this.chart.plotSizeY/b)}return a};d.prototype.hasData=function(){return!!this.processedXData.length};d.prototype.pointAttribs=function(a,c){if(!a)return{};var n=this,d=n.mapOptionsToLevel[(a.isNode?a.level:a.fromNode.level)||0]||{},f=a.options,p=d.states&&d.states[c||""]||{};c=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce(function(a,b){a[b]=q(p[b],f[b],d[b],n.options[b]);return a},{});var e=q(p.color,f.color,c.colorByPoint?a.color:d.color);return a.isNode?{fill:e,
stroke:c.borderColor,"stroke-width":c.borderWidth,opacity:c.opacity}:{fill:b.parse(e).setOpacity(c.linkOpacity).get()}};d.prototype.drawTracker=function(){x.prototype.drawTracker.call(this,this.points);x.prototype.drawTracker.call(this,this.nodes)};d.prototype.drawPoints=function(){x.prototype.drawPoints.call(this,this.points);x.prototype.drawPoints.call(this,this.nodes)};d.prototype.drawDataLabels=function(){x.prototype.drawDataLabels.call(this,this.points);x.prototype.drawDataLabels.call(this,this.nodes)};
d.prototype.translate=function(){this.processedXData||this.processData();this.generatePoints();this.nodeColumns=this.createNodeColumns();this.nodeWidth=w(this.options.nodeWidth,this.chart.plotSizeX);var a=this,b=this.chart,c=this.options,d=this.nodeWidth,f=this.nodeColumns;this.nodePadding=this.getNodePadding();this.translationFactor=f.reduce(function(b,c){return Math.min(b,c.sankeyColumn.getTranslationFactor(a))},Infinity);this.colDistance=(b.plotSizeX-d-c.borderWidth)/Math.max(1,f.length-1);a.mapOptionsToLevel=
z({from:1,levels:c.levels,to:f.length-1,defaults:{borderColor:c.borderColor,borderRadius:c.borderRadius,borderWidth:c.borderWidth,color:a.color,colorByPoint:c.colorByPoint,levelIsConstant:!0,linkColor:c.linkColor,linkLineWidth:c.linkLineWidth,linkOpacity:c.linkOpacity,states:c.states}});f.forEach(function(b){b.forEach(function(c){a.translateNode(c,b)})},this);this.nodes.forEach(function(b){b.linksFrom.forEach(function(b){(b.weight||b.isNull)&&b.to&&(a.translateLink(b),b.allowShadow=!1)})})};d.prototype.translateLink=
function(a){var b=function(b,c){c=b.offset(a,c)*n;return Math.min(b.nodeY+c,b.nodeY+(b.shapeArgs&&b.shapeArgs.height||0)-e)},c=a.fromNode,d=a.toNode,f=this.chart,n=this.translationFactor,e=Math.max(a.weight*n,this.options.minLinkWidth),h=(f.inverted?-this.colDistance:this.colDistance)*this.options.curveFactor,g=b(c,"linksFrom");b=b(d,"linksTo");var k=c.nodeX,l=this.nodeWidth;d=d.nodeX;var m=a.outgoing,q=d>k+l;f.inverted&&(g=f.plotSizeY-g,b=(f.plotSizeY||0)-b,l=-l,e=-e,q=k>d);a.shapeType="path";a.linkBase=
[g,g+e,b,b+e];if(q&&"number"===typeof b)a.shapeArgs={d:[["M",k+l,g],["C",k+l+h,g,d-h,b,d,b],["L",d+(m?l:0),b+e/2],["L",d,b+e],["C",d-h,b+e,k+l+h,g+e,k+l,g+e],["Z"]]};else if("number"===typeof b){h=d-20-e;m=d-20;q=k+l;var r=q+20,u=r+e,w=g,t=g+e,x=t+20,y=x+(f.plotHeight-g-e),v=y+20,z=v+e,C=b,A=C+e,E=A+20,F=v+.7*e,G=d-.7*e,H=q+.7*e;a.shapeArgs={d:[["M",q,w],["C",H,w,u,t-.7*e,u,x],["L",u,y],["C",u,F,H,z,q,z],["L",d,z],["C",G,z,h,F,h,y],["L",h,E],["C",h,A-.7*e,G,C,d,C],["L",d,A],["C",m,A,m,A,m,E],["L",
m,y],["C",m,v,m,v,d,v],["L",q,v],["C",r,v,r,v,r,y],["L",r,x],["C",r,t,r,t,q,t],["Z"]]}}a.dlBox={x:k+(d-k+l)/2,y:g+(b-g)/2,height:e,width:0};a.tooltipPos=f.inverted?[f.plotSizeY-a.dlBox.y-e/2,f.plotSizeX-a.dlBox.x]:[a.dlBox.x,a.dlBox.y+e/2];a.y=a.plotY=1;a.x=a.plotX=1;a.color||(a.color=c.color)};d.prototype.translateNode=function(a,b){var c=this.translationFactor,e=this.chart,f=this.options,g=f.borderRadius,h=f.borderWidth,k=void 0===h?0:h,l=a.getSum();h=Math.max(Math.round(l*c),this.options.minLinkWidth);
var n=Math.round(this.nodeWidth),m=Math.round(k)%2/2,p=b.sankeyColumn.offset(a,c);b=Math.floor(q(p.absoluteTop,b.sankeyColumn.top(c)+p.relativeTop))+m;c=Math.floor(this.colDistance*a.column+k/2)+w(a.options.offsetHorizontal||0,n)+m;c=e.inverted?e.plotSizeX-c:c;(a.sum=l)?(a.shapeType="roundedRect",a.nodeX=c,a.nodeY=b,l=c,k=b,m=a.options.width||f.width||n,p=a.options.height||f.height||h,g=y(w("object"===typeof g?g.radius:g||0,m),0,h/2),e.inverted&&(l=c-n,k=e.plotSizeY-b-h,m=a.options.height||f.height||
n,p=a.options.width||f.width||h),a.dlOptions=d.getDLOptions({level:this.mapOptionsToLevel[a.level],optionsPoint:a.options}),a.plotX=1,a.plotY=1,a.tooltipPos=e.inverted?[e.plotSizeY-k-p/2,e.plotSizeX-l-m/2]:[l+m/2,k+p/2],a.shapeArgs={x:l,y:k,width:m,height:p,r:g,display:a.hasShape()?"":"none"}):a.dlOptions={enabled:!1}};d.defaultOptions=r(x.defaultOptions,u);return d}(x);l.compose(k,e);c(e.prototype,{animate:d.prototype.animate,createNode:l.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,
noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:k,searchPoint:h.noop});v.registerSeriesType("sankey",e);"";return e});u(b,"masters/modules/sankey.src.js",[],function(){})});
//# sourceMappingURL=sankey.js.map