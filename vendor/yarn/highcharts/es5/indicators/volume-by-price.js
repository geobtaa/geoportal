/*
 Highstock JS v11.1.0 (2023-06-05)

 Indicator series type for Highcharts Stock

 (c) 2010-2021 Pawe Dalek

 License: www.highcharts.com/license
*/
'use strict';(function(a){"object"===typeof module&&module.exports?(a["default"]=a,module.exports=a):"function"===typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(p){a(p);a.Highcharts=p;return a}):a("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(a){function p(a,m,x,g){a.hasOwnProperty(m)||(a[m]=g.apply(null,x),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:m,
module:a[m]}})))}a=a?a._modules:{};p(a,"Stock/Indicators/VBP/VBPPoint.js",[a["Core/Series/SeriesRegistry.js"]],function(a){var m=this&&this.__extends||function(){var a=function(g,b){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var g in b)Object.prototype.hasOwnProperty.call(b,g)&&(a[g]=b[g])};return a(g,b)};return function(g,b){function m(){this.constructor=g}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+
" is not a constructor or null");a(g,b);g.prototype=null===b?Object.create(b):(m.prototype=b.prototype,new m)}}();return function(a){function g(){return null!==a&&a.apply(this,arguments)||this}m(g,a);g.prototype.destroy=function(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy());a.prototype.destroy.apply(this,arguments)};return g}(a.seriesTypes.sma.prototype.pointClass)});p(a,"Stock/Indicators/VBP/VBPIndicator.js",[a["Stock/Indicators/VBP/VBPPoint.js"],a["Core/Animation/AnimationUtilities.js"],
a["Core/Globals.js"],a["Core/Series/SeriesRegistry.js"],a["Core/Utilities.js"],a["Core/Chart/StockChart.js"]],function(a,m,p,g,b,H){var x=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,k){c.__proto__=k}||function(c,k){for(var a in k)Object.prototype.hasOwnProperty.call(k,a)&&(c[a]=k[a])};return a(b,c)};return function(b,c){function y(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+
String(c)+" is not a constructor or null");a(b,c);b.prototype=null===c?Object.create(c):(y.prototype=c.prototype,new y)}}(),I=m.animObject;m=p.noop;p=g.seriesTypes;var z=p.column.prototype,D=p.sma,A=b.addEvent,E=b.arrayMax,J=b.arrayMin,B=b.correctFloat,F=b.defined,C=b.error,G=b.extend,K=b.isArray,L=b.merge,u=Math.abs;b=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c.data=void 0;c.negWidths=void 0;c.options=void 0;c.points=void 0;c.posWidths=void 0;c.priceZones=void 0;c.rangeStep=
void 0;c.volumeDataArray=void 0;c.zoneStarts=void 0;c.zoneLinesSVG=void 0;return c}x(b,a);b.prototype.init=function(c,b){var k=this;delete b.data;a.prototype.init.apply(k,arguments);var d=A(H,"afterLinkSeries",function(){if(k.options){var a=k.linkedParent,b=c.get(k.options.params.volumeSeriesID);k.addCustomEvents(a,b)}d()},{order:1});return k};b.prototype.addCustomEvents=function(c,a){var b=this,d=function(){b.chart.redraw();b.setData([]);b.zoneStarts=[];b.zoneLinesSVG&&(b.zoneLinesSVG=b.zoneLinesSVG.destroy())};
b.dataEventsToUnbind.push(A(c,"remove",function(){d()}));a&&b.dataEventsToUnbind.push(A(a,"remove",function(){d()}));return b};b.prototype.animate=function(c){var b=this,a=b.chart.inverted,d=b.group,n={};!c&&d&&(c=a?b.yAxis.top:b.xAxis.left,a?(d["forceAnimate:translateY"]=!0,n.translateY=c):(d["forceAnimate:translateX"]=!0,n.translateX=c),d.animate(n,G(I(b.options.animation),{step:function(c,a){b.group.attr({scaleX:Math.max(.001,a.pos)})}})))};b.prototype.drawPoints=function(){this.options.volumeDivision.enabled&&
(this.posNegVolume(!0,!0),z.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1));z.drawPoints.apply(this,arguments)};b.prototype.posNegVolume=function(b,a){var c=a?["positive","negative"]:["negative","positive"],d=this.options.volumeDivision,n=this.points.length,r=[],l=[],f=0,h;b?(this.posWidths=r,this.negWidths=l):(r=this.posWidths,l=this.negWidths);for(;f<n;f++){var e=this.points[f];e[c[0]+"Graphic"]=e.graphic;e.graphic=e[c[1]+"Graphic"];if(b){var y=e.shapeArgs.width;var v=this.priceZones[f];
(h=v.wholeVolumeData)?(r.push(y/h*v.positiveVolumeData),l.push(y/h*v.negativeVolumeData)):(r.push(0),l.push(0))}e.color=a?d.styles.positiveColor:d.styles.negativeColor;e.shapeArgs.width=a?this.posWidths[f]:this.negWidths[f];e.shapeArgs.x=a?e.shapeArgs.x:this.posWidths[f]}};b.prototype.translate=function(){var b=this,a=b.options,k=b.chart,d=b.yAxis,n=d.min,r=b.options.zoneLines,l=b.priceZones,f=0,h,e,g;z.translate.apply(b);var v=b.points;if(v.length){var m=.5>a.pointPadding?a.pointPadding:.1;a=b.volumeDataArray;
var p=E(a);var q=k.plotWidth/2;var M=k.plotTop;var w=u(d.toPixels(n)-d.toPixels(n+b.rangeStep));var x=u(d.toPixels(n)-d.toPixels(n+b.rangeStep));m&&(n=u(w*(1-2*m)),f=u((w-n)/2),w=u(n));v.forEach(function(a,c){e=a.barX=a.plotX=0;g=a.plotY=d.toPixels(l[c].start)-M-(d.reversed?w-x:w)-f;h=B(q*l[c].wholeVolumeData/p);a.pointWidth=h;a.shapeArgs=b.crispCol.apply(b,[e,g,h,w]);a.volumeNeg=l[c].negativeVolumeData;a.volumePos=l[c].positiveVolumeData;a.volumeAll=l[c].wholeVolumeData});r.enabled&&b.drawZones(k,
d,b.zoneStarts,r.styles)}};b.prototype.getValues=function(b,a){var c=b.processedXData,d=b.processedYData,n=this.chart,r=a.ranges,l=[],f=[],h=[],e=n.get(a.volumeSeriesID);if(b.chart)if(e&&e.processedXData.length)if((a=K(d[0]))&&4!==d[0].length)C("Type of "+b.name+" series is different than line, OHLC or candlestick.",!0,n);else return(this.priceZones=this.specifyZones(a,c,d,r,e)).forEach(function(b,a){l.push([b.x,b.end]);f.push(l[a][0]);h.push(l[a][1])}),{values:l,xData:f,yData:h};else C("Series "+
a.volumeSeriesID+(e&&!e.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`."),!0,n);else C("Base series not found! In case it has been removed, add a new one.",!0,n)};b.prototype.specifyZones=function(b,a,k,d,n){if(b){var c=k.length;for(var l=k[0][3],f=l,h=1,e;h<c;h++)e=k[h][3],e<l&&(l=e),e>f&&(f=e);c={min:l,max:f}}else c=!1;h=c;c=this.zoneStarts=[];l=[];f=h?h.min:J(k);e=h?h.max:E(k);var g=0;h=1;var m=this.linkedParent;!this.options.compareToMain&&m.dataModify&&
(f=m.dataModify.modifyValue(f),e=m.dataModify.modifyValue(e));if(!F(f)||!F(e))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];m=this.rangeStep=B(e-f)/d;for(c.push(f);g<d-1;g++)c.push(B(c[g]+m));c.push(e);for(d=c.length;h<d;h++)l.push({index:h-1,x:a[0],start:c[h-1],end:c[h]});return this.volumePerZone(b,l,n,a,k)};b.prototype.volumePerZone=function(b,a,k,d,n){var c=this,l=k.processedXData,f=k.processedYData,h=a.length-
1,e=n.length;k=f.length;var g,m,p,t,q;u(e-k)&&(d[0]!==l[0]&&f.unshift(0),d[e-1]!==l[k-1]&&f.push(0));c.volumeDataArray=[];a.forEach(function(a){a.wholeVolumeData=0;a.positiveVolumeData=0;for(q=a.negativeVolumeData=0;q<e;q++){p=m=!1;t=b?n[q][3]:n[q];g=q?b?n[q-1][3]:n[q-1]:t;var d=c.linkedParent;!c.options.compareToMain&&d.dataModify&&(t=d.dataModify.modifyValue(t),g=d.dataModify.modifyValue(g));t<=a.start&&0===a.index&&(m=!0);t>=a.end&&a.index===h&&(p=!0);(t>a.start||m)&&(t<a.end||p)&&(a.wholeVolumeData+=
f[q],g>t?a.negativeVolumeData+=f[q]:a.positiveVolumeData+=f[q])}c.volumeDataArray.push(a.wholeVolumeData)});return a};b.prototype.drawZones=function(a,b,k,d){var c=a.renderer,g=a.plotWidth,l=a.plotTop,f=this.zoneLinesSVG,h=[],e;k.forEach(function(c){e=b.toPixels(c)-l;h=h.concat(a.renderer.crispLine([["M",0,e],["L",g,e]],d.lineWidth))});f?f.animate({d:h}):f=this.zoneLinesSVG=c.path(h).attr({"stroke-width":d.lineWidth,stroke:d.color,dashstyle:d.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)};
b.defaultOptions=L(D.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1E3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",
padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}});return b}(D);G(b.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:a,markerAttribs:m,drawGraph:m,getColumnMetrics:z.getColumnMetrics,crispCol:z.crispCol});g.registerSeriesType("vbp",b);"";return b});p(a,"masters/indicators/volume-by-price.src.js",[],function(){})});
//# sourceMappingURL=volume-by-price.js.map