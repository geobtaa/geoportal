/*
 Highstock JS v11.1.0 (2023-06-05)

 Indicator series type for Highcharts Stock

 (c) 2010-2021 Pawe Dalek

 License: www.highcharts.com/license
*/
'use strict';(function(a){"object"===typeof module&&module.exports?(a["default"]=a,module.exports=a):"function"===typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts","highcharts/modules/stock"],function(p){a(p);a.Highcharts=p;return a}):a("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(a){function p(a,l,p,u){a.hasOwnProperty(l)||(a[l]=u.apply(null,p),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:l,
module:a[l]}})))}a=a?a._modules:{};p(a,"Stock/Indicators/VBP/VBPPoint.js",[a["Core/Series/SeriesRegistry.js"]],function(a){({sma:{prototype:{pointClass:a}}}=a.seriesTypes);class l extends a{destroy(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy());super.destroy.apply(this,arguments)}}return l});p(a,"Stock/Indicators/VBP/VBPIndicator.js",[a["Stock/Indicators/VBP/VBPPoint.js"],a["Core/Animation/AnimationUtilities.js"],a["Core/Globals.js"],a["Core/Series/SeriesRegistry.js"],
a["Core/Utilities.js"],a["Core/Chart/StockChart.js"]],function(a,l,p,u,G,H){const {animObject:I}=l;({noop:l}=p);const {column:{prototype:w},sma:B}=u.seriesTypes,{addEvent:y,arrayMax:C,arrayMin:J,correctFloat:z,defined:D,error:A,extend:E,isArray:K,merge:L}=G,v=Math.abs;class x extends B{constructor(){super(...arguments);this.zoneLinesSVG=this.zoneStarts=this.volumeDataArray=this.rangeStep=this.priceZones=this.posWidths=this.points=this.options=this.negWidths=this.data=void 0}init(c,e){const b=this;
delete e.data;super.init.apply(b,arguments);const d=y(H,"afterLinkSeries",function(){if(b.options){const d=b.linkedParent,e=c.get(b.options.params.volumeSeriesID);b.addCustomEvents(d,e)}d()},{order:1});return b}addCustomEvents(c,e){const b=this,d=()=>{b.chart.redraw();b.setData([]);b.zoneStarts=[];b.zoneLinesSVG&&(b.zoneLinesSVG=b.zoneLinesSVG.destroy())};b.dataEventsToUnbind.push(y(c,"remove",function(){d()}));e&&b.dataEventsToUnbind.push(y(e,"remove",function(){d()}));return b}animate(c){const e=
this,b=e.chart.inverted,d=e.group,a={};!c&&d&&(c=b?e.yAxis.top:e.xAxis.left,b?(d["forceAnimate:translateY"]=!0,a.translateY=c):(d["forceAnimate:translateX"]=!0,a.translateX=c),d.animate(a,E(I(e.options.animation),{step:function(b,c){e.group.attr({scaleX:Math.max(.001,c.pos)})}})))}drawPoints(){this.options.volumeDivision.enabled&&(this.posNegVolume(!0,!0),w.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1));w.drawPoints.apply(this,arguments)}posNegVolume(c,e){const b=e?["positive","negative"]:
["negative","positive"],d=this.options.volumeDivision,a=this.points.length;let t=[],k=[],f=0,h,g,n,m;c?(this.posWidths=t,this.negWidths=k):(t=this.posWidths,k=this.negWidths);for(;f<a;f++)m=this.points[f],m[b[0]+"Graphic"]=m.graphic,m.graphic=m[b[1]+"Graphic"],c&&(h=m.shapeArgs.width,g=this.priceZones[f],(n=g.wholeVolumeData)?(t.push(h/n*g.positiveVolumeData),k.push(h/n*g.negativeVolumeData)):(t.push(0),k.push(0))),m.color=e?d.styles.positiveColor:d.styles.negativeColor,m.shapeArgs.width=e?this.posWidths[f]:
this.negWidths[f],m.shapeArgs.x=e?m.shapeArgs.x:this.posWidths[f]}translate(){const c=this;var e=c.options;const b=c.chart,d=c.yAxis;var a=d.min;const t=c.options.zoneLines,k=c.priceZones;let f=0,h,g,n,m,l,r,q,F,p;w.translate.apply(c);const u=c.points;u.length&&(r=.5>e.pointPadding?e.pointPadding:.1,e=c.volumeDataArray,h=C(e),g=b.plotWidth/2,q=b.plotTop,n=v(d.toPixels(a)-d.toPixels(a+c.rangeStep)),m=v(d.toPixels(a)-d.toPixels(a+c.rangeStep)),r&&(a=v(n*(1-2*r)),f=v((n-a)/2),n=v(a)),u.forEach(function(a,
b){F=a.barX=a.plotX=0;p=a.plotY=d.toPixels(k[b].start)-q-(d.reversed?n-m:n)-f;l=z(g*k[b].wholeVolumeData/h);a.pointWidth=l;a.shapeArgs=c.crispCol.apply(c,[F,p,l,n]);a.volumeNeg=k[b].negativeVolumeData;a.volumePos=k[b].positiveVolumeData;a.volumeAll=k[b].wholeVolumeData}),t.enabled&&c.drawZones(b,d,c.zoneStarts,t.styles))}getValues(a,e){const b=a.processedXData,d=a.processedYData,c=this.chart,t=e.ranges,k=[],f=[],h=[],g=c.get(e.volumeSeriesID);if(a.chart)if(g&&g.processedXData.length)if((e=K(d[0]))&&
4!==d[0].length)A("Type of "+a.name+" series is different than line, OHLC or candlestick.",!0,c);else return(this.priceZones=this.specifyZones(e,b,d,t,g)).forEach(function(a,b){k.push([a.x,a.end]);f.push(k[b][0]);h.push(k[b][1])}),{values:k,xData:f,yData:h};else A("Series "+e.volumeSeriesID+(g&&!g.processedXData.length?" does not contain any data.":" not found! Check `volumeSeriesID`."),!0,c);else A("Base series not found! In case it has been removed, add a new one.",!0,c)}specifyZones(a,e,b,d,l){if(a){var c=
b.length;for(var k=b[0][3],f=k,h=1,g;h<c;h++)g=b[h][3],g<k&&(k=g),g>f&&(f=g);c={min:k,max:f}}else c=!1;h=c;c=this.zoneStarts=[];k=[];f=h?h.min:J(b);g=h?h.max:C(b);let n=0;h=1;var m=this.linkedParent;!this.options.compareToMain&&m.dataModify&&(f=m.dataModify.modifyValue(f),g=m.dataModify.modifyValue(g));if(!D(f)||!D(g))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];m=this.rangeStep=z(g-f)/d;for(c.push(f);n<d-1;n++)c.push(z(c[n]+
m));c.push(g);for(d=c.length;h<d;h++)k.push({index:h-1,x:e[0],start:c[h-1],end:c[h]});return this.volumePerZone(a,k,l,e,b)}volumePerZone(a,e,b,d,l){const c=this,k=b.processedXData,f=b.processedYData,h=e.length-1,g=l.length;b=f.length;let n,m,p,r,q;v(g-b)&&(d[0]!==k[0]&&f.unshift(0),d[g-1]!==k[b-1]&&f.push(0));c.volumeDataArray=[];e.forEach(function(b){b.wholeVolumeData=0;b.positiveVolumeData=0;for(q=b.negativeVolumeData=0;q<g;q++){p=m=!1;r=a?l[q][3]:l[q];n=q?a?l[q-1][3]:l[q-1]:r;const d=c.linkedParent;
!c.options.compareToMain&&d.dataModify&&(r=d.dataModify.modifyValue(r),n=d.dataModify.modifyValue(n));r<=b.start&&0===b.index&&(m=!0);r>=b.end&&b.index===h&&(p=!0);(r>b.start||m)&&(r<b.end||p)&&(b.wholeVolumeData+=f[q],n>r?b.negativeVolumeData+=f[q]:b.positiveVolumeData+=f[q])}c.volumeDataArray.push(b.wholeVolumeData)});return e}drawZones(a,e,b,d){const c=a.renderer,l=a.plotWidth,k=a.plotTop;let f=this.zoneLinesSVG,h=[],g;b.forEach(function(b){g=e.toPixels(b)-k;h=h.concat(a.renderer.crispLine([["M",
0,g],["L",l,g]],d.lineWidth))});f?f.animate({d:h}):f=this.zoneLinesSVG=c.path(h).attr({"stroke-width":d.lineWidth,stroke:d.color,dashstyle:d.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)}}x.defaultOptions=L(B.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},
animationLimit:1E3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}});E(x.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:a,markerAttribs:l,drawGraph:l,getColumnMetrics:w.getColumnMetrics,crispCol:w.crispCol});u.registerSeriesType("vbp",
x);"";return x});p(a,"masters/indicators/volume-by-price.src.js",[],function(){})});
//# sourceMappingURL=volume-by-price.js.map